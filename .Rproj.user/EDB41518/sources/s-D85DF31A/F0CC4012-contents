---
title: "Shuttle3"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
library(rms)
library(ResourceSelection)
shuttle <- read.csv("C7 Shuttle.csv")
cancer <- read.csv("C7 Cancer2.csv")
tattoos <- read.csv("C7 Tatoos.csv")
sirds <-read.csv("C7 SIRDS.csv")
```


```{r}
table(shuttle$Successful.Launch)
shuttle$Successful.Launch <- as.character(shuttle$Successful.Launch)
shuttle <- shuttle %>%
  filter(Successful.Launch !="*")
shuttle$Successful.Launch <- as.numeric(shuttle$Successful.Launch)
shuttle <- shuttle %>%
  mutate(Failure = 1 - Successful.Launch  )
```

```{r}
shuttle%>%
  ggplot(aes(Ambient.Temperature..oF.,Failure))+
  geom_point()+
  geom_smooth(method = "lm",colour = "red")+
  stat_smooth(method = "glm",method.args = list(family= "binomial"))
```
it predicts 
```{r}
reg <- glm(Failure~Ambient.Temperature..oF.,shuttle,family = binomial)
summary(reg)
exp(-0.2322+0.196)
exp(-0.23212-0.196)
```
```{r}
lrm(Failure~Ambient.Temperature..oF.,shuttle)
```
C: 78% of pairs of 0 and 1 fit the model (0.5->1)
Dxy: rescaling C 
deviance shows how significant our variables
dxy shows how good our model fit the data
```{r}
shuttle2 <- shuttle %>% mutate(res=resid(reg),fit = fitted(reg))
shuttle2 %>%
  ggplot(aes(res))+
  geom_histogram()
```
residual plot isn't good, it's not symmetric
```{r}
1 - pchisq(28.267-20.315,1)
hoslem.test(shuttle2$Failure,shuttle2$fit)
```
test for binomiality and 

larger X, further from binomial 
p-value large -> we can't reject the binomiality

we want 1-pchisq to be small  


log reg good for prob (when y is 0 and 1)
lin reg when y is continuous
log reg can also do interaction terms