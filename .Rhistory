stat_smooth(method = "glm",method.args = list(family= "binomial")) +
labs(title = "Relation")
bankTrain %>%
ggplot(aes(month, euribor3m, color = deposit)) + geom_point()
bankTrain %>%
ggplot(aes(euribor3m, deposit)) + geom_point() +
stat_smooth(method = "glm",method.args = list(family= "binomial")) +
facet_wrap(~month) +
labs(title = "Relation")
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign, bankTrain)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign, bankTrain, maxit=1000)
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign, bankTrain, maxit=1000)
table(bankTrain$education)
bankTrain <- bankTrain %>%
mutate(higherEd = ifelse(education == "professional.course" | education == "university.degree", 1 ,0))
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + higherEd, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign + higherEd, bankTrain, maxit=1000)
View(reg)
bankTrain %>%
ggplot(aes(euribor3m, deposit)) + geom_point() +
stat_smooth(method = "glm",method.args = list(family= "binomial")) +
facet_wrap(~month) +
labs(title = "Relationship between euribor3m and deposit based on month")
exp(-0.4850)
exp(0.4850)
exp(0.16)
source("~/.active-rstudio-document", echo=TRUE)
pchisq(12803-12267,16-7,lower.tail = FALSE)
pchisq(21272 - 12016, 27, lower.tail = FALSE)
bankTrain2 <- bankTrain1 %>%
mutate(res = resid(reg6), fit = fitted(reg6))
bankTrain2 <- bankTrain %>%
mutate(res = resid(reg6), fit = fitted(reg6))
bankTrain2 %>% ggplot(aes(res)) + geom_histogram() + labs(title = "Histogram of residuals")
hoslem.test(bankTrain2$deposit, bankTrain2$fit)
hoslem.test(bankTrain2$deposit, bankTrain2$fit, g=4)
hoslem.test(bankTrain2$deposit, bankTrain2$fit)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(rms)
library(ResourceSelection)
library(naniar)
bankDf <- read.csv2("bank-additional-full.csv")
summary(bankDf)
glimpse(bankDf)
View(bankDf)
source("~/.active-rstudio-document", echo=TRUE)
bankDf <- read.csv2("bank-additional-full.csv")
summary(bankDf)
glimpse(bankDf)
bankDf <- read.csv2("bank-additional-full.csv")
bankDf <- read.csv2("bank-additional-full.csv")
summary(bankDf)
glimpse(bankDf)
bankTrain %>%
ggplot(aes(x = job, color = deposit)) + geom_bar() + labs(title = "Distribution of deposit based on job") + theme(axis.text.x = element_text(angle = 10))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(rms)
library(ResourceSelection)
library(naniar)
bankDf <- read.csv2("bank-additional-full.csv")
summary(bankDf)
glimpse(bankDf)
bankDf <- bankDf %>% replace_with_na_all(condition = ~.x == "unknown")
bankDf <- rename(bankDf, telephone = contact)
bankDf <- rename(bankDf, deposit = y)
bankDf <- bankDf %>%
mutate(default = ifelse(default == "yes", 1, 0)) %>%
mutate(housing = ifelse(housing == "yes", 1, 0)) %>%
mutate(loan = ifelse(loan == "yes", 1, 0)) %>%
mutate(telephone = ifelse(telephone == "telephone", 1, 0)) %>%
mutate(deposit = ifelse(deposit == "yes", 1, 0))
bankDf$job <- as.factor(bankDf$job)
bankDf$marital <- as.factor(bankDf$marital)
bankDf$education <- as.factor(bankDf$education)
bankDf$default <- as.factor(bankDf$default)
bankDf$housing <- as.factor(bankDf$housing)
bankDf$loan <- as.factor(bankDf$loan)
bankDf$telephone <- as.factor(bankDf$telephone)
bankDf$poutcome <- as.factor(bankDf$poutcome)
bankDf$month <- as.factor(bankDf$month)
bankDf$day_of_week <- as.factor(bankDf$day_of_week)
bankDf$previous <- as.numeric(bankDf$previous)
bankDf$emp.var.rate <- as.numeric(bankDf$emp.var.rate)
bankDf$cons.price.idx <- as.numeric(bankDf$cons.price.idx)
bankDf$cons.conf.idx <- as.numeric(bankDf$cons.conf.idx)
bankDf$euribor3m <- as.numeric(bankDf$euribor3m)
bankDf$nr.employed <- as.numeric(bankDf$nr.employed)
bankDf$pdays <- as.factor(bankDf$pdays)
summary(bankDf)
bankDf <- bankDf %>%
select(!default) %>%
select(!poutcome) %>%
select(!pdays)
bankDf <- na.omit(bankDf)
summary(bankDf)
set.seed(1)
N <- seq(38245)
S <- sample(N,30596)
bankTrain <- bankDf[S,]
bankTest <- bankDf[-S,]
summary(bankTrain)
summary(bankTest)
bankTrain %>%
ggplot(aes(age)) + geom_histogram() +
labs(title = "Histogram of age")
bankTrain %>%
ggplot(aes(duration)) + geom_histogram() +
labs(title = "Histogram of duration")
bankTrain %>%
ggplot(aes(campaign)) + geom_histogram() +
labs(title = "Histogram of campaign")
bankTrain %>%
ggplot(aes(previous)) + geom_histogram() +
labs(title = "Histogram of previous")
table(bankTrain$previous)
#log transformation
bankTrain <- bankTrain %>%
mutate(logDuration = log(duration))
bankTrain <- bankTrain %>%
mutate(logCampaign = log(campaign))
bankTrain %>%
ggplot(aes(logDuration)) + geom_histogram() +
labs(title = "Histogram of logDuration")
bankTrain %>%
ggplot(aes(logCampaign)) + geom_histogram() +
labs(title = "Histogram of logCampaign")
bankTrain <- bankTrain %>%
select(!logCampaign) %>%
select(!duration)
summary(bankDf)
summary(bankDf)
summary(bankDf)
summary(bankDf)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(rms)
library(ResourceSelection)
library(naniar)
bankDf <- read.csv2("bank-additional-full.csv")
summary(bankDf)
glimpse(bankDf)
bankDf <- bankDf %>% replace_with_na_all(condition = ~.x == "unknown")
bankDf <- rename(bankDf, telephone = contact)
bankDf <- rename(bankDf, deposit = y)
bankDf <- bankDf %>%
mutate(default = ifelse(default == "yes", 1, 0)) %>%
mutate(housing = ifelse(housing == "yes", 1, 0)) %>%
mutate(loan = ifelse(loan == "yes", 1, 0)) %>%
mutate(telephone = ifelse(telephone == "telephone", 1, 0)) %>%
mutate(deposit = ifelse(deposit == "yes", 1, 0))
bankDf$job <- as.factor(bankDf$job)
bankDf$marital <- as.factor(bankDf$marital)
bankDf$education <- as.factor(bankDf$education)
bankDf$default <- as.factor(bankDf$default)
bankDf$housing <- as.factor(bankDf$housing)
bankDf$loan <- as.factor(bankDf$loan)
bankDf$telephone <- as.factor(bankDf$telephone)
bankDf$poutcome <- as.factor(bankDf$poutcome)
bankDf$month <- as.factor(bankDf$month)
bankDf$day_of_week <- as.factor(bankDf$day_of_week)
bankDf$previous <- as.numeric(bankDf$previous)
bankDf$emp.var.rate <- as.numeric(bankDf$emp.var.rate)
bankDf$cons.price.idx <- as.numeric(bankDf$cons.price.idx)
bankDf$cons.conf.idx <- as.numeric(bankDf$cons.conf.idx)
bankDf$euribor3m <- as.numeric(bankDf$euribor3m)
bankDf$nr.employed <- as.numeric(bankDf$nr.employed)
bankDf$pdays <- as.factor(bankDf$pdays)
summary(bankDf)
bankDf <- bankDf %>%
select(!default) %>%
select(!poutcome) %>%
select(!pdays)
bankDf <- na.omit(bankDf)
summary(bankDf)
set.seed(1)
N <- seq(38245)
S <- sample(N,30596)
bankTrain <- bankDf[S,]
bankTest <- bankDf[-S,]
summary(bankTrain)
summary(bankTest)
bankTrain %>%
ggplot(aes(age)) + geom_histogram() +
labs(title = "Histogram of age")
bankTrain %>%
ggplot(aes(duration)) + geom_histogram() +
labs(title = "Histogram of duration")
bankTrain %>%
ggplot(aes(campaign)) + geom_histogram() +
labs(title = "Histogram of campaign")
bankTrain %>%
ggplot(aes(previous)) + geom_histogram() +
labs(title = "Histogram of previous")
table(bankTrain$previous)
#log transformation
bankTrain <- bankTrain %>%
mutate(logDuration = log(duration))
bankTrain <- bankTrain %>%
mutate(logCampaign = log(campaign))
bankTrain %>%
ggplot(aes(logDuration)) + geom_histogram() +
labs(title = "Histogram of logDuration")
bankTrain %>%
ggplot(aes(logCampaign)) + geom_histogram() +
labs(title = "Histogram of logCampaign")
bankTrain <- bankTrain %>%
select(!logCampaign) %>%
select(!duration)
bankTrain %>%
ggplot(aes(x = job, color = deposit)) + geom_bar() + labs(title = "Distribution of deposit based on job") + theme(axis.text.x = element_text(angle = 10))
bankTrain %>%
ggplot(aes(x = job, fill = deposit)) + geom_bar() + labs(title = "Distribution of deposit based on job") + theme(axis.text.x = element_text(angle = 10))
bankTrain <- bankTrain %>%
filter(logDuration != -Inf)
reg <- glm(deposit ~ ., bankTrain, family = binomial)
summary(reg)
reg2 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain, family = binomial)
summary(reg2)
reg3 <- glm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + euribor3m + cons.conf.idx + logDuration, bankTrain, family = binomial)
summary(reg3)
reg4 <- glm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + logDuration, bankTrain, family = binomial)
summary(reg4)
# Drop-in deviance tests
pchisq(21272-12182,43,lower.tail = FALSE)
pchisq(21272-12267,16,lower.tail = FALSE)
pchisq(21272-12803,7,lower.tail = FALSE)
pchisq(21272-12803,6,lower.tail = FALSE)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain)
lrm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + logDuration, bankTrain)
# Drop-in deviance test for month
pchisq(12803-12267,16-7,lower.tail = FALSE)
bankTrain$month <- relevel(bankTrain$month, ref = "aug")
reg5 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain, family = binomial)
summary(reg5)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain)
bankTrain %>%
ggplot(aes(euribor3m, deposit)) + geom_point() +
stat_smooth(method = "glm",method.args = list(family= "binomial")) +
facet_wrap(~month) +
labs(title = "Relationship between euribor3m and deposit based on month")
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign, bankTrain, maxit=1000)
table(bankTrain$education)
bankTrain <- bankTrain %>%
mutate(higherEd = ifelse(education == "professional.course" | education == "university.degree", 1 ,0))
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + higherEd, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign + higherEd, bankTrain, maxit=1000)
exp(0.4850)
exp(0.16)
pchisq(21272 - 12016, 27, lower.tail = FALSE)
bankTrain2 <- bankTrain %>%
mutate(res = resid(reg6), fit = fitted(reg6))
bankTrain2 %>% ggplot(aes(res)) + geom_histogram() + labs(title = "Histogram of residuals")
hoslem.test(bankTrain2$deposit, bankTrain2$fit)
table(bankTrain$deposit)
set.seed(1)
N <- seq(38245)
S <- sample(N,30596)
bankTrain <- bankDf[S,]
bankTest <- bankDf[-S,]
summary(bankTrain)
summary(bankTest)
table(bankTrain$deposit)
table(bankTrain$deposit)
bankTrain <- bankTrain[S,]
N <- seq(30596)
S <- sample(N,4000)
bankTrain <- bankTrain[S,]
set.seed(1)
N <- seq(38245)
S <- sample(N,30596)
bankTrain <- bankDf[S,]
bankTest <- bankDf[-S,]
summary(bankTrain)
summary(bankTest)
table(bankTrain$deposit)
N <- seq(30596)
S <- sample(N,4000)
bankTrain <- bankTrain[S,]
bankTrain %>%
ggplot(aes(age)) + geom_histogram() +
labs(title = "Histogram of age")
bankTrain %>%
ggplot(aes(duration)) + geom_histogram() +
labs(title = "Histogram of duration")
bankTrain %>%
ggplot(aes(campaign)) + geom_histogram() +
labs(title = "Histogram of campaign")
bankTrain %>%
ggplot(aes(previous)) + geom_histogram() +
labs(title = "Histogram of previous")
table(bankTrain$previous)
#log transformation
bankTrain <- bankTrain %>%
mutate(logDuration = log(duration))
bankTrain <- bankTrain %>%
mutate(logCampaign = log(campaign))
bankTrain %>%
ggplot(aes(logDuration)) + geom_histogram() +
labs(title = "Histogram of logDuration")
bankTrain %>%
ggplot(aes(logCampaign)) + geom_histogram() +
labs(title = "Histogram of logCampaign")
bankTrain <- bankTrain %>%
select(!logCampaign) %>%
select(!duration)
bankTrain %>%
ggplot(aes(x = job, color = deposit)) + geom_bar() + labs(title = "Distribution of deposit based on job") + theme(axis.text.x = element_text(angle = 10))
bankTrain %>%
ggplot(aes(x = job, fill = deposit)) + geom_bar() + labs(title = "Distribution of deposit based on job") + theme(axis.text.x = element_text(angle = 10))
bankTrain <- bankTrain %>%
filter(logDuration != -Inf)
reg <- glm(deposit ~ ., bankTrain, family = binomial)
summary(reg)
reg2 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain, family = binomial)
summary(reg2)
reg3 <- glm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + euribor3m + cons.conf.idx + logDuration, bankTrain, family = binomial)
summary(reg3)
reg4 <- glm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + logDuration, bankTrain, family = binomial)
summary(reg4)
# Drop-in deviance tests
pchisq(21272-12182,43,lower.tail = FALSE)
pchisq(21272-12267,16,lower.tail = FALSE)
pchisq(21272-12803,7,lower.tail = FALSE)
pchisq(21272-12803,6,lower.tail = FALSE)
pchisq(2862.9-1527.4,43,lower.tail = FALSE)
# Drop-in deviance tests
pchisq(21272-12182,43,lower.tail = FALSE)
pchisq(21272-12267,16,lower.tail = FALSE)
pchisq(21272-12803,7,lower.tail = FALSE)
pchisq(21272-12803,6,lower.tail = FALSE)
pchisq(2862.9-1495.2,43,lower.tail = FALSE)
pchisq(2862.9-1527.4,16,lower.tail = FALSE)
pchisq(2862.9-1626,7,lower.tail = FALSE)
pchisq(2862.9-1626.2,6,lower.tail = FALSE)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain)
lrm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + logDuration, bankTrain)
# Drop-in deviance test for month
pchisq(12803-12267,16-7,lower.tail = FALSE)
bankTrain$month <- relevel(bankTrain$month, ref = "aug")
reg5 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain, family = binomial)
summary(reg5)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain)
bankTrain %>%
ggplot(aes(euribor3m, deposit)) + geom_point() +
stat_smooth(method = "glm",method.args = list(family= "binomial")) +
facet_wrap(~month) +
labs(title = "Relationship between euribor3m and deposit based on month")
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign, bankTrain, maxit=1000)
table(bankTrain$education)
bankTrain <- bankTrain %>%
mutate(higherEd = ifelse(education == "professional.course" | education == "university.degree", 1 ,0))
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + higherEd, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign + higherEd, bankTrain, maxit=1000)
lrm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign + higherEd, bankTrain, maxit=1000)
table(bankTrain$education)
bankTrain <- bankTrain %>%
mutate(higherEd = ifelse(education == "professional.course" | education == "university.degree", 1 ,0))
reg6 <- glm(deposit ~ telephone  + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + higherEd, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign + higherEd, bankTrain, maxit=1000)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(rms)
library(ResourceSelection)
library(naniar)
bankDf <- read.csv2("bank-additional-full.csv")
summary(bankDf)
glimpse(bankDf)
bankDf <- bankDf %>% replace_with_na_all(condition = ~.x == "unknown")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(rms)
library(ResourceSelection)
library(naniar)
bankDf <- read.csv2("bank-additional-full.csv")
summary(bankDf)
glimpse(bankDf)
bankDf <- bankDf %>% replace_with_na_all(condition = ~.x == "unknown")
bankDf <- rename(bankDf, telephone = contact)
bankDf <- rename(bankDf, deposit = y)
bankDf <- bankDf %>%
#mutate(employed = ifelse(employed == "unemployed", 0, 1)) %>%
mutate(default = ifelse(default == "yes", 1, 0)) %>%
mutate(housing = ifelse(housing == "yes", 1, 0)) %>%
mutate(loan = ifelse(loan == "yes", 1, 0)) %>%
mutate(telephone = ifelse(telephone == "telephone", 1, 0)) %>%
mutate(deposit = ifelse(deposit == "yes", 1, 0))
#bankDf$employed <- as.factor(bankDf$employed)
bankDf$job <- as.factor(bankDf$job)
bankDf$marital <- as.factor(bankDf$marital)
bankDf$education <- as.factor(bankDf$education)
bankDf$default <- as.factor(bankDf$default)
bankDf$housing <- as.factor(bankDf$housing)
bankDf$loan <- as.factor(bankDf$loan)
bankDf$telephone <- as.factor(bankDf$telephone)
bankDf$poutcome <- as.factor(bankDf$poutcome)
bankDf$month <- as.factor(bankDf$month)
bankDf$day_of_week <- as.factor(bankDf$day_of_week)
bankDf$previous <- as.numeric(bankDf$previous)
bankDf$emp.var.rate <- as.numeric(bankDf$emp.var.rate)
bankDf$cons.price.idx <- as.numeric(bankDf$cons.price.idx)
bankDf$cons.conf.idx <- as.numeric(bankDf$cons.conf.idx)
bankDf$euribor3m <- as.numeric(bankDf$euribor3m)
bankDf$nr.employed <- as.numeric(bankDf$nr.employed)
bankDf$pdays <- as.factor(bankDf$pdays)
summary(bankDf)
bankDf <- bankDf %>%
select(!default) %>%
select(!poutcome) %>%
select(!pdays)
bankDf <- na.omit(bankDf)
summary(bankDf)
set.seed(1)
N <- seq(38245)
S <- sample(N,30596)
bankTrain <- bankDf[S,]
bankTest <- bankDf[-S,]
summary(bankTrain)
summary(bankTest)
bankTrain %>%
ggplot(aes(age)) + geom_histogram() +
labs(title = "Histogram of age")
bankTrain %>%
ggplot(aes(duration)) + geom_histogram() +
labs(title = "Histogram of duration")
bankTrain %>%
ggplot(aes(campaign)) + geom_histogram() +
labs(title = "Histogram of campaign")
bankTrain %>%
ggplot(aes(previous)) + geom_histogram() +
labs(title = "Histogram of previous")
table(bankTrain$previous)
#log transformation
bankTrain <- bankTrain %>%
mutate(logDuration = log(duration))
bankTrain <- bankTrain %>%
mutate(logCampaign = log(campaign))
bankTrain %>%
ggplot(aes(logDuration)) + geom_histogram() +
labs(title = "Histogram of logDuration")
bankTrain %>%
ggplot(aes(logCampaign)) + geom_histogram() +
labs(title = "Histogram of logCampaign")
bankTrain <- bankTrain %>%
select(!logCampaign) %>%
select(!duration)
bankTrain %>%
ggplot(aes(x = job, fill = deposit)) + geom_bar() + labs(title = "Distribution of deposit based on job") + theme(axis.text.x = element_text(angle = 10))
bankTrain %>%
ggplot(aes(x = job, fill = deposit)) + geom_bar() + labs(title = "Distribution of deposit based on job") + theme(axis.text.x = element_text(angle = 10))
bankTrain <- bankTrain %>%
filter(logDuration != -Inf)
reg <- glm(deposit ~ ., bankTrain, family = binomial)
summary(reg)
reg2 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain, family = binomial)
summary(reg2)
reg3 <- glm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + euribor3m + cons.conf.idx + logDuration, bankTrain, family = binomial)
summary(reg3)
reg4 <- glm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + logDuration, bankTrain, family = binomial)
summary(reg4)
# Drop-in deviance tests
pchisq(21272-12182,43,lower.tail = FALSE)
pchisq(21272-12267,16,lower.tail = FALSE)
pchisq(21272-12803,7,lower.tail = FALSE)
pchisq(21272-12803,6,lower.tail = FALSE)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain)
lrm(deposit ~ telephone + previous + emp.var.rate + cons.price.idx + cons.conf.idx + logDuration, bankTrain)
# Drop-in deviance test for month
pchisq(12803-12267,16-7,lower.tail = FALSE)
bankTrain$month <- relevel(bankTrain$month, ref = "aug")
reg5 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain, family = binomial)
summary(reg5)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration, bankTrain)
bankTrain %>%
ggplot(aes(euribor3m, deposit)) + geom_point() +
stat_smooth(method = "glm",method.args = list(family= "binomial")) +
facet_wrap(~month) +
labs(title = "Relationship between euribor3m and deposit based on month")
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign, bankTrain, maxit=1000)
table(bankTrain$education)
bankTrain <- bankTrain %>%
mutate(higherEd = ifelse(education == "professional.course" | education == "university.degree", 1 ,0))
reg6 <- glm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + higherEd, bankTrain, family = binomial)
summary(reg6)
lrm(deposit ~ telephone + month + previous + emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + logDuration + month*euribor3m + campaign + higherEd, bankTrain, maxit=1000)
exp(0.4850)
exp(0.16)
pchisq(21272 - 12016, 27, lower.tail = FALSE)
bankTrain2 <- bankTrain %>%
mutate(res = resid(reg6), fit = fitted(reg6))
bankTrain2 %>% ggplot(aes(res)) + geom_histogram() + labs(title = "Histogram of residuals")
hoslem.test(bankTrain2$deposit, bankTrain2$fit)
